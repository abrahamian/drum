(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{t=this}t.Ciseaux=e()}})(function(){var e,t,n;return function r(e,t,n){function a(i,o){if(!t[i]){if(!e[i]){var f=typeof require=="function"&&require;if(!o&&f)return f(i,!0);if(u)return u(i,!0);var s=new Error("Cannot find module '"+i+"'");throw s.code="MODULE_NOT_FOUND",s}var l=t[i]={exports:{}};e[i][0].call(l.exports,function(t){var n=e[i][1][t];return a(n?n:t)},l,l.exports,r,e,t,n)}return t[i].exports}var u=typeof require=="function"&&require;for(var i=0;i<n.length;i++)a(n[i]);return a}({1:[function(e,t,n){e("./lib/browser-interface")();t.exports=e("./lib")},{"./lib":5,"./lib/browser-interface":2}],2:[function(e,t,n){(function(r){"use strict";Object.defineProperty(n,"__esModule",{value:true});function a(e){return e&&e.__esModule?e:{"default":e}}var u=e("audiodata");var i=a(u);var o=e("./tape");var f=a(o);var s=e("./config");var l=a(s);var c=e("./renderer");var d=a(c);var h=r.AudioContext||r.webkitAudioContext;function m(e){return new Promise(function(t,n){var a=new r.XMLHttpRequest;a.open("GET",e);a.responseType="arraybuffer";a.onload=function(){if(a.status===200){t(a.response)}else{n(new Error(a.statusText))}};a.onerror=function(){n(new Error(a.statusText))};a.send()})}function p(e){if(l["default"].context===null){l["default"].context=new h}return new Promise(function(t,n){l["default"].context.decodeAudioData(e,function(e){t(v(e))},n)})}function v(e){return i["default"].fromAudioBuffer(e)}function g(e){if(e instanceof f["default"]){return Promise.resolve(e.clone())}if(i["default"].isAudioData(e)){return Promise.resolve(new f["default"](e))}if(e instanceof r.AudioBuffer){return Promise.resolve(new f["default"](v(e)))}if(l["default"].context===null){l["default"].context=new h}if(e instanceof ArrayBuffer){return p(e).then(g)}if(typeof e==="string"){return m(e).then(g)}return Promise.reject(new Error("Invalid arguments"))}function y(e){var t=arguments[1]===undefined?0:arguments[1];t=Math.max(t,e.numberOfChannels);e.numberOfChannels=t;if(l["default"].context===null){l["default"].context=new h}return d["default"].render(e).then(function(t){return i["default"].toAudioBuffer({sampleRate:e.sampleRate,channelData:t},l["default"].context)})}n["default"]=function(){l["default"].load=m;l["default"].decode=p;l["default"].from=g;l["default"].render=y};t.exports=n["default"]}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./config":3,"./renderer":7,"./tape":9,audiodata:11}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});n["default"]={context:null,sampleRate:0,load:null,decode:null,from:null,render:null};t.exports=n["default"]},{}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var u=function(){function e(t,n,r){a(this,e);this.data=t;this.beginTime=n;this.endTime=r;this.gain=1;this.pan=0;this.reverse=false;this.pitch=1;this.stretch=false}r(e,[{key:"slice",value:function t(e,n){e=this.beginTime+e*this.pitch;var r=e+n*this.pitch;e=Math.max(this.beginTime,e);r=Math.max(e,Math.min(r,this.endTime));return this.clone({beginTime:e,endTime:r})}},{key:"clone",value:function n(t){var n=new e(this.data,this.beginTime,this.endTime);n.gain=this.gain;n.pan=this.pan;n.reverse=this.reverse;n.pitch=this.pitch;n.stretch=this.stretch;if(t){Object.keys(t).forEach(function(e){n[e]=t[e]})}return n}},{key:"toJSON",value:function u(){return{data:this.data,beginTime:this.beginTime,endTime:this.endTime,gain:this.gain,pan:this.pan,reverse:this.reverse,pitch:this.pitch,stretch:this.stretch}}},{key:"duration",get:function i(){return(this.endTime-this.beginTime)/this.pitch}}]);return e}();n["default"]=u;t.exports=n["default"]},{}],5:[function(e,t,n){(function(r){"use strict";Object.defineProperty(n,"__esModule",{value:true});var a=Function.prototype.bind;function u(e){return e&&e.__esModule?e:{"default":e}}var i=e("./sequence");var o=u(i);var f=e("./tape");var s=u(f);var l=e("./config");var c=u(l);var d=r.AudioContext||r.webkitAudioContext;n["default"]=Object.defineProperties({load:function h(e){return c["default"].load(e)},decode:function m(e){return c["default"].decode(e)},Sequence:o["default"],Tape:s["default"],from:function p(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++){t[n]=arguments[n]}if(c["default"].from){return c["default"].from.apply(c["default"],t)}return Promise.resolve(new(a.apply(s["default"],[null].concat(t))))},silence:s["default"].silence,concat:s["default"].concat,mix:s["default"].mix},{context:{get:function v(){return c["default"].context},set:function g(e){if(d&&e instanceof d){c["default"].context=e}},configurable:true,enumerable:true}});t.exports=n["default"]}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./config":3,"./sequence":8,"./tape":9}],6:[function(e,t,n){(function(e){"use strict";var self=e.self||{};var n={};self.repository=[];self.onmessage=function(e){switch(e.data.type){case"transfer":self.repository[e.data.data]=e.data.buffers.map(function(e){return new Float32Array(e)});break;case"dispose":delete self.repository[e.data.data];break;case"render":self.startRendering(e.data.tape,e.data.callbackId);break}};self.startRendering=function(e,t){var n=self.allocData(e);var r=n.map(function(e){return e.buffer});self.render(e,n);self.postMessage({callbackId:t,buffers:r},r)};self.allocData=function(e){var t=new Array(e.numberOfChannels);var n=Math.floor(e.duration*e.sampleRate);for(var r=0;r<t.length;r++){t[r]=new Float32Array(n)}return t};self.render=function(e,t){for(var n=0;n<e.tracks.length;n++){self.renderTrack(n,e.tracks[n],t,e.sampleRate)}};self.renderTrack=function(e,t,n,r){var a=t.some(function(e){return e.pan!==0});var u=0;for(var i=0,o=t.length;i<o;i++){var f=t[i];var s=self.repository[f.data];var l=(f.endTime-f.beginTime)/f.pitch;var c=Math.floor(l*r);if(!s){u+=c;continue}var d=Math.floor(f.beginTime*r);var h=Math.floor(f.endTime*r);var m=s.length;var p=n.length;var v=self.subarray(s,d,h);var g=self.subarray(n,u,u+c);var y=f.pitch;var b=e===0&&y===1&&!a&&f.gain===1&&!f.reverse&&m<=p&&v[0].length===g[0].length;if(b){self.mix[v.length+"->"+g.length](v,g)}else{self.process(v,g,{gain:f.gain,pan:a?Math.max(-1,Math.min(f.pan,+1)):null,reverse:!!f.reverse})}u+=c}};self.subarray=function(e,t,n){var r=new Array(e.length);for(var a=0;a<r.length;a++){r[a]=e[a].subarray(t,n)}return r};self.process=function(e,t,n){var r=new Array(e.length);var a=e.length;var u=t.length;var i=undefined;var o=e[0].length;var f=t[0].length;var s=(o-1)/(f-1);var l=undefined,c=undefined,d=undefined,h=undefined,m=undefined,p=undefined;if(n.pan!==null){m=Math.cos((n.pan+1)*.25*Math.PI);p=Math.sin((n.pan+1)*.25*Math.PI);i=Math.max(a,2)}else{i=a}h=self.mix1[i+"->"+u]||self.mix1.nop;if(n.reverse){l=t[0].length-1;c=-1}else{l=0;c=+1}for(var v=0;v<f;v++,l+=c){var g=v*s;var y=g|0;var b=Math.min(y+1,o-1);for(d=0;d<a;d++){r[d]=e[d][y]+Math.abs(g-y)*(e[d][b]-e[d][y])}if(n.pan!==null){r=self.pan[a](r,m,p)}var k=h(r);for(d=0;d<u;d++){t[d][l]+=(k[d]||0)*n.gain}}};self.pan=[];self.pan[1]=function(e,t,n){return[e[0]*t,e[0]*n]};self.pan[2]=function(e,t,n){var r=(e[0]+e[1])*.5;return[r*t,r*n]};self.pan[4]=function(e,t,n){var r=(e[0]+e[1])*.5;var a=(e[2]+e[3])*.5;return[r*t,r*n,a*t,a*n]};self.pan[6]=function(e,t,n){var r=(e[0]+e[1])*.5;var a=(e[4]+e[5])*.5;return[r*t,r*n,e[2],e[3],a*t,a*n]};self.mix={};self.mix["1->1"]=function(e,t){t[0].set(e[0])};self.mix["1->2"]=function(e,t){t[0].set(e[0]);t[1].set(e[0])};self.mix["1->4"]=function(e,t){t[0].set(e[0]);t[1].set(e[0])};self.mix["1->6"]=function(e,t){t[2].set(e[0])};self.mix["2->2"]=function(e,t){t[0].set(e[0]);t[1].set(e[1])};self.mix["2->4"]=function(e,t){t[0].set(e[0]);t[1].set(e[1])};self.mix["2->6"]=function(e,t){t[0].set(e[0]);t[1].set(e[1])};self.mix["4->4"]=function(e,t){t[0].set(e[0]);t[1].set(e[1]);t[2].set(e[2]);t[3].set(e[3])};self.mix["4->6"]=function(e,t){t[0].set(e[0]);t[1].set(e[1]);t[4].set(e[2]);t[5].set(e[3])};self.mix["6->6"]=function(e,t){t[0].set(e[0]);t[1].set(e[1]);t[2].set(e[2]);t[3].set(e[3]);t[4].set(e[4]);t[5].set(e[5])};self.mix1={};self.mix1.nop=function(e){return e};self.mix1["1->2"]=function(e){return[e[0],e[0]]};self.mix1["1->4"]=function(e){return[e[0],e[0],0,0]};self.mix1["1->6"]=function(e){return[0,0,e[0],0,0,0]};self.mix1["2->4"]=function(e){return[e[0],e[1],0,0]};self.mix1["2->6"]=function(e){return[e[0],e[1],0,0,0,0]};self.mix1["4->6"]=function(e){return[e[0],e[1],0,0,e[2],e[3]]};self.mix1["2->1"]=function(e){return[.5*(e[0]+e[1])]};self.mix1["4->1"]=function(e){return[.25*(e[0]+e[1]+e[2]+e[3])]};self.mix1["6->1"]=function(e){return[.7071*(e[0]+e[1])+e[2]+.5*(e[4]+e[5])]};self.mix1["4->2"]=function(e){return[.5*(e[0]+e[2]),.5*(e[1]+e[3])]};self.mix1["6->2"]=function(e){return[e[0]+.7071*(e[2]+e[4]),e[1]+.7071*(e[2]+e[5])]};self.mix1["6->4"]=function(e){return[e[0]+.7071*e[2],e[1]+.7071*e[2],e[4],e[5]]};n.self=n.util=self;t.exports=n}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});function r(e){return e&&e.__esModule?e:{"default":e}}var a=e("ouroboros-worker");var u=r(a);var i=e("./render-worker");var o=r(i);var f=new u["default"](o["default"].self);var s=[];var l=1;f.onmessage=function(e){var t=e.data.buffers.map(function(e){return new Float32Array(e)});s[e.data.callbackId](t);s[e.data.callbackId]=null};n["default"]={transfer:function c(e){var t=l++;var n=e.channelData.map(function(e){return e.buffer});f.postMessage({type:"transfer",data:t,buffers:n},n);return t},dispose:function d(e){f.postMessage({type:"dispose",data:e})},render:function h(e){var t=s.length;f.postMessage({type:"render",tape:e,callbackId:t});return new Promise(function(e){s[t]=e})},util:o["default"].util};t.exports=n["default"]},{"./render-worker":6,"ouroboros-worker":12}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();function a(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var i=e("./tape");var o=a(i);var f=e("./config");var s=a(f);function l(e,t){var n=Object.keys(e);for(var r=0;r<n.length;r++){var a=/^\/(.+)?\/(\w*)$/.exec(n[r]);if(a&&new RegExp(a[1],a[2]).test(t)){return e[n[r]]}}return null}function c(e,t,n,r){var a=null;if(e.hasOwnProperty(t)){a=e[t]}else{a=l(e,t)}if(typeof a==="function"){a=a(t,n,r)}return a instanceof o["default"]?a:null}var d=function(){function e(){var t=this;u(this,e);this.pattern=this.instruments=this.durationPerStep=null;for(var n=arguments.length,r=Array(n),a=0;a<n;a++){r[a]=arguments[a]}r.forEach(function(e){if(typeof e==="string"){t.pattern=e}else if(typeof e==="number"||Array.isArray(e)){t.durationPerStep=e}else if(typeof e==="object"){t.instruments=e}})}r(e,[{key:"apply",value:function t(){var e=this.pattern;var t=this.instruments;var n=this.durationPerStep;for(var r=arguments.length,a=Array(r),u=0;u<r;u++){a[u]=arguments[u]}a.forEach(function(r){if(typeof r==="string"){e=r}else if(typeof r==="number"||Array.isArray(r)){n=r}else if(typeof r==="object"){t=r}});if(e===null||t===null||n===null){return o["default"].silence(0)}var i=Array.isArray(n)?n:[n];return e.split("").reduce(function(e,n,r){var a=c(t,n,r,e);var u=i[r%i.length];u=Math.max(0,+u||0);if(a!==null){if(a.duration<u){e=e.concat(a,o["default"].silence(u-a.duration))}else{e=e.concat(a.slice(0,u))}}else{e=e.concat(o["default"].silence(u))}return e},new o["default"](1,s["default"].sampleRate))}}]);return e}();n["default"]=d;t.exports=n["default"]},{"./config":3,"./tape":9}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=function w(e,t,n){var r=true;e:while(r){var a=e,u=t,i=n;o=f=s=undefined;r=false;if(a===null)a=Function.prototype;var o=Object.getOwnPropertyDescriptor(a,u);if(o===undefined){var f=Object.getPrototypeOf(a);if(f===null){return undefined}else{e=f;t=u;n=i;r=true;continue e}}else if("value"in o){return o.value}else{var s=o.get;if(s===undefined){return undefined}return s.call(i)}}};var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();function u(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)e.__proto__=t}function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var f=e("audiodata");var s=u(f);var l=e("./track");var c=u(l);var d=e("./fragment");var h=u(d);var m=e("./config");var p=u(m);var v=e("./renderer");var g=u(v);var y={};var b=function(){function e(t,n){o(this,e);if(s["default"].isAudioData(t)){return new k(t)}this.tracks=[new c["default"]];this._numberOfChannels=Math.max(1,t|0);this._sampleRate=Math.max(0,n|0)||p["default"].sampleRate}a(e,[{key:"gain",value:function t(){var t=arguments[0]===undefined?1:arguments[0];t=y.toNumber(t);var n=new e(this.numberOfChannels,this.sampleRate);n.tracks=this.tracks.map(function(e){return e.gain(t)});return n}},{key:"pan",value:function n(){var t=arguments[0]===undefined?0:arguments[0];t=y.toNumber(t);var n=new e(this.numberOfChannels,this.sampleRate);n.tracks=this.tracks.map(function(e){return e.pan(t)});return n}},{key:"reverse",value:function r(){var t=new e(this.numberOfChannels,this.sampleRate);t.tracks=this.tracks.map(function(e){return e.reverse()});return t}},{key:"pitch",value:function u(){var t=arguments[0]===undefined?1:arguments[0];t=Math.max(0,y.toNumber(t));var n=new e(this.numberOfChannels,this.sampleRate);n.tracks=this.tracks.map(function(e){return e.pitch(t)});return n}},{key:"stretch",value:function i(){var t=arguments[0]===undefined?1:arguments[0];t=Math.max(0,y.toNumber(t));var n=new e(this.numberOfChannels,this.sampleRate);n.tracks=this.tracks.map(function(e){return e.stretch(t)});return n}},{key:"clone",value:function f(){var t=new e(this.numberOfChannels,this.sampleRate);t.tracks=this.tracks.map(function(e){return e.clone()});return t}},{key:"silence",value:function l(){var t=arguments[0]===undefined?0:arguments[0];t=Math.max(0,y.toNumber(t));var n=new e(this.numberOfChannels,this.sampleRate);if(0<t){n.tracks=this.tracks.map(function(){return c["default"].silence(t)})}return n}},{key:"concat",value:function d(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++){n[r]=arguments[r]}n=Array.prototype.concat.apply([],n);var a=new e(this.numberOfChannels,this.sampleRate);a.tracks=this.tracks.map(function(e){return e.clone()});n.forEach(function(t){if(!(t instanceof e&&0<t.duration)){return}if(a._numberOfChannels<t._numberOfChannels){a._numberOfChannels=t._numberOfChannels}if(a.numberOfTracks<t.numberOfTracks){a=y.adjustNumberOfTracks(a,t.numberOfTracks)}if(t.numberOfTracks<a.numberOfTracks){t=y.adjustNumberOfTracks(t,a.numberOfTracks)}t.tracks.forEach(function(e,t){a.tracks[t].append(e)})});return a}},{key:"slice",value:function h(){var t=arguments[0]===undefined?0:arguments[0];var n=arguments[1]===undefined?Infinity:arguments[1];t=y.toNumber(t);n=Math.max(0,y.toNumber(n));if(t<0){t+=this.duration}t=Math.max(0,t);var r=new e(this.numberOfChannels,this.sampleRate);r.tracks=this.tracks.map(function(e){return e.slice(t,n)});return r}},{key:"loop",value:function m(){var t=arguments[0]===undefined?2:arguments[0];t=Math.max(0,t|0);var n=new Array(t);for(var r=0;r<n.length;r++){n[r]=this}return new e(this.numberOfChannels,this.sampleRate).concat(n)}},{key:"fill",value:function v(){var e=arguments[0]===undefined?this.duration:arguments[0];e=Math.max(0,y.toNumber(e));var t=this.duration;if(t===0){return this.silence(e)}var n=Math.floor(e/t);var r=e%t;return this.loop(n).concat(this.slice(0,r))}},{key:"replace",value:function g(){var e=arguments[0]===undefined?0:arguments[0];var t=arguments[1]===undefined?0:arguments[1];var n=arguments[2]===undefined?null:arguments[2];e=y.toNumber(e);t=Math.max(0,y.toNumber(t));if(e<0){e+=this.duration}e=Math.max(0,e);if(typeof n==="function"){n=n(this.slice(e,t))}return this.slice(0,e).concat(n,this.slice(e+t))}},{key:"split",value:function b(){var e=arguments[0]===undefined?2:arguments[0];e=Math.max(0,e|0);var t=new Array(e);var n=this.duration/e;for(var r=0;r<e;r++){t[r]=this.slice(n*r,n)}return t}},{key:"mix",value:function w(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++){n[r]=arguments[r]}n=Array.prototype.concat.apply([],n);var a=undefined;if(typeof n[n.length-1]==="string"){a=n.pop()}var u=new e(this.numberOfChannels,this.sampleRate);u.tracks=this.tracks.map(function(e){return e.clone()});n.forEach(function(t){if(!(t instanceof e&&0<t.duration)){return}if(u._numberOfChannels<t._numberOfChannels){u._numberOfChannels=t._numberOfChannels}if(u.duration<t.duration){u=y.adjustDuration(u,t.duration,a)}if(t.duration<u.duration){t=y.adjustDuration(t,u.duration,a)}u.tracks=u.tracks.concat(t.tracks)});return u}},{key:"render",value:function x(){if(p["default"].render){for(var e=arguments.length,t=Array(e),n=0;n<e;n++){t[n]=arguments[n]}return p["default"].render.apply(p["default"],[this.toJSON()].concat(t))}return new Promise(function(e,t){t(new Error("not implemented"))})}},{key:"dispose",value:function O(){}},{key:"toJSON",value:function M(){var e=this.tracks.map(function(e){return e.toJSON()});var t=this.duration;var n=this.sampleRate;var r=this.numberOfChannels;var a=e.some(function(e){return e.some(function(e){return e.pan!==0})});if(a){r=Math.max(2,r)}return{tracks:e,duration:t,sampleRate:n,numberOfChannels:r}}},{key:"sampleRate",get:function T(){return this._sampleRate||p["default"].sampleRate}},{key:"length",get:function _(){return Math.floor(this.duration*this.sampleRate)}},{key:"duration",get:function C(){return this.tracks[0].duration}},{key:"numberOfChannels",get:function R(){return this._numberOfChannels}},{key:"numberOfTracks",get:function A(){return this.tracks.length}}],[{key:"silence",value:function P(t){return new e(1,p["default"].sampleRate).silence(t)}},{key:"concat",value:function j(){var t;return(t=new e(1,p["default"].sampleRate)).concat.apply(t,arguments)}},{key:"mix",value:function D(){var t;var n=(t=new e(1,p["default"].sampleRate)).mix.apply(t,arguments);if(1<n.tracks.length){n.tracks.shift()}return n}}]);return e}();n["default"]=b;var k=function(e){function t(e){o(this,t);r(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,s["default"].getNumberOfChannels(e),e.sampleRate);var n=s["default"].getDuration(e);this._data=g["default"].transfer(e);this.tracks[0].addFragment(new h["default"](this._data,0,n));p["default"].sampleRate=p["default"].sampleRate||e.sampleRate}i(t,e);a(t,[{key:"dispose",value:function n(){g["default"].dispose(this._data)}}]);return t}(b);n.TransferredTape=k;y.toNumber=function(e){return+e||0};y.adjustNumberOfTracks=function(e,t){var n=new b(e.numberOfChannels,e.sampleRate);n.tracks=e.tracks.map(function(e){return e.clone()});var r=t-n.numberOfTracks;var a=n.duration;for(var u=0;u<r;u++){n.tracks.push(c["default"].silence(a))}return n};y.adjustDuration=function(e,t,n){if(e.duration===0){return e.silence(t)}switch(n){case"fill":return e.fill(t);case"pitch":return e.pitch(e.duration/t);case"stretch":return e.stretch(e.duration/t);default:return e.concat(e.silence(t-e.duration))}}},{"./config":3,"./fragment":4,"./renderer":7,"./track":10,audiodata:11}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();function a(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var i=e("./fragment");var o=a(i);var f=function(){function e(){var t=arguments[0]===undefined?[]:arguments[0];var n=arguments[1]===undefined?0:arguments[1];u(this,e);this.fragments=t;if(t.length!==0&&n===0){n=t.reduce(function(e,t){return e+t.duration},0)}this.duration=n}r(e,[{key:"gain",value:function t(n){return new e(this.fragments.map(function(e){return e.clone({gain:e.gain*n})}),this.duration)}},{key:"pan",value:function n(t){return new e(this.fragments.map(function(e){return e.clone({pan:e.pan+t})}),this.duration)}},{key:"reverse",value:function a(){return new e(this.fragments.map(function(e){return e.clone({reverse:!e.reverse})}).reverse(),this.duration)}},{key:"pitch",value:function i(t){return new e(this.fragments.map(function(e){return e.clone({pitch:e.pitch*t,stretch:false})}),0)}},{key:"stretch",value:function f(t){return new e(this.fragments.map(function(e){return e.clone({pitch:e.pitch*t,stretch:true})}),0)}},{key:"clone",value:function s(){return new e(this.fragments.slice(),this.duration)}},{key:"slice",value:function l(t,n){var r=new e;var a=Math.max(0,t);var u=n;for(var i=0;0<u&&i<this.fragments.length;i++){if(this.fragments[i].duration<=a){a-=this.fragments[i].duration}else{var o=this.fragments[i].slice(a,u);r.addFragment(o);a=0;u-=o.duration}}return r}},{key:"toJSON",value:function c(){return this.fragments.map(function(e){return e.toJSON()})}},{key:"addFragment",value:function d(e){if(e instanceof o["default"]&&0<e.duration){this.fragments.push(e);this.duration+=e.duration}return this}},{key:"append",value:function h(t){var n=this;if(t instanceof e){t.fragments.forEach(function(e){n.addFragment(e)})}return this}}],[{key:"silence",value:function m(t){return new e([new o["default"](0,0,t)],t)}}]);return e}();n["default"]=f;t.exports=n["default"]},{"./fragment":4}],11:[function(e,t,n){function r(e){return!!(e&&typeof e.sampleRate==="number"&&Array.isArray(e.channelData))}function a(e){return e.sampleRate}function u(e){return e.channelData.length}function i(e){return e.channelData[0].length}function o(e){return e.channelData[0].length/e.sampleRate}function f(e,t){return e.channelData[t]}function s(e,t){var n=u(e);var r=i(e);var o=a(e);var s=t.createBuffer(n,r,o);var l;if(s.copyToChannel){for(l=0;l<n;l++){s.copyToChannel(f(e,l),l)}}else{for(l=0;l<n;l++){s.getChannelData(l).set(f(e,l))}}return s}function l(e){var t=e.sampleRate;var n=new Array(e.numberOfChannels);var r;for(r=0;r<n.length;r++){n[r]=e.getChannelData(r)}return{sampleRate:t,channelData:n}}t.exports={isAudioData:r,getSampleRate:a,getNumberOfChannels:u,getLength:i,getDuration:o,getChannelData:f,toAudioBuffer:s,fromAudioBuffer:l}},{}],12:[function(e,t,n){t.exports=e("./lib/ouroboros-worker")},{"./lib/ouroboros-worker":13}],13:[function(e,t,n){(function(e){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var u=!!(e===e.window&&e.URL&&e.Worker);var i=!!(e===e.self&&e.location);var o=u&&function(){var t=e.document.getElementsByTagName("script");var n=t[t.length-1].src;return new e.URL(n).pathname}();var f=function(){function t(){var n=this;var self=arguments[0]===undefined?{}:arguments[0];a(this,t);if(u){return new e.Worker(o)}if(i){return{}}this.self=self;this.self.postMessage=function(e){setTimeout(function(){if(typeof n.onmessage==="function"){n.onmessage({data:e})}},0)}}r(t,[{key:"postMessage",value:function n(e){var t=this;setTimeout(function(){if(typeof t.self.onmessage==="function"){t.self.onmessage({data:e})}},0)}}]);return t}();n["default"]=f;t.exports=n["default"]}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}]},{},[1])(1)});